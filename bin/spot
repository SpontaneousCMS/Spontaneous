#!/usr/bin/env ruby

$KCODE = 'u' if RUBY_VERSION < '1.9.0'

require 'rubygems' unless defined?(Gem) # Useful only on --dev mode
require 'bundler'

begin
	Bundler.setup(:default)
rescue Bundler::GemfileNotFound
	# We're operating outside of a site dir, probably generating a site
	# so load the Spontaneous gem Gemfile
  ENV['BUNDLE_GEMFILE'] = File.expand_path('../../Gemfile', __FILE__)
	retry
rescue Bundler::GemNotFound => e
  STDERR.puts e.message
  STDERR.puts "Try running `bundle install`."
  exit!
end

spot_path = File.expand_path('../../lib', __FILE__)
$:.unshift(spot_path) if File.directory?(spot_path) && !$:.include?(spot_path)

require 'spontaneous/cli'
Spontaneous::Cli::Runner.start(ARGV)
